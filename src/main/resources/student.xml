<TAPbProto package="Sensor" syntax="proto2" version="20180312">
    <messages root_msg="SENSOR_LOG">
        <message type="TCPFLOW">
            <fields>
                <field>
                    <id>1</id>
                    <name>serial_num</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>2</id>
                    <name>status</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>3</id>
                    <name>stime</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>4</id>
                    <name>dtime</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>5</id>
                    <name>sip</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>6</id>
                    <name>sipv6</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>7</id>
                    <name>sport</name>
                    <label>required</label>
                    <type>int32</type>
                </field>
                <field>
                    <id>8</id>
                    <name>dip</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>9</id>
                    <name>dipv6</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>10</id>
                    <name>dport</name>
                    <label>required</label>
                    <type>int32</type>
                </field>
                <field>
                    <id>11</id>
                    <name>proto</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>12</id>
                    <name>uplink_length</name>
                    <label>required</label>
                    <type>uint64</type>
                </field>
            </fields>
        </message>
        <message type="MAIL_BEHAVIOR">
            <fields>
                <field>
                    <id>1</id>
                    <name>serial_num</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>2</id>
                    <name>proto</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>3</id>
                    <name>access_time</name>
                    <label>required</label>
                    <type>string</type>
                </field>
                <field>
                    <id>4</id>
                    <name>sip</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>5</id>
                    <name>sipv6</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>6</id>
                    <name>dip</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>7</id>
                    <name>dipv6</name>
                    <label>optional</label>
                    <type>string</type>
                </field>
                <field>
                    <id>8</id>
                    <name>sport</name>
                    <label>required</label>
                    <type>int32</type>
                </field>
                <field>
                    <id>9</id>
                    <name>dport</name>
                    <label>required</label>
                    <type>int32</type>
                </field>
                <field>
                    <id>10</id>
                    <name>attachment</name>
                    <label>repeated</label>
                    <type>mail_attachment</type>
                </field>
            </fields>
        </message>
		<message type="mail_attachment">
			<fields>
				<field>
					<id>1</id>
					<name>attach_md5</name>
					<label>required</label>
					<type>string</type>
				</field>
				<field>
					<id>2</id>
					<name>mime_type</name>
					<label>required</label>
					<type>string</type>
				</field>
				<field>
					<id>3</id>
					<name>name</name>
					<label>required</label>
					<type>string</type>
				</field>
			</fields>
		</message>
        <message type="SENSOR_LOG">
            <fields>
                <field>
                    <id>1</id>
                    <name>message_type</name>
                    <label>required</label>
                    <type>int32</type>
                </field>
                <field>
                    <id>2</id>
                    <name>skyeye_tcpflow</name>
                    <label>optional</label>
                    <type>TCPFLOW</type>
                </field>
                <field>
                    <id>3</id>
                    <name>skyeye_mail</name>
                    <label>optional</label>
                    <type>MAIL_BEHAVIOR</type>
                </field>
            </fields>
        </message>
    </messages>
</TAPbProto>
